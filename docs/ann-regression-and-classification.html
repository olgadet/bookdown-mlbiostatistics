<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning</title>
  <meta name="description" content="Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning" />
  
  <meta name="twitter:description" content="Chapter 13 ANN regression and classification | Introduction to biostatistics and machine learning" />
  

<meta name="author" content="Olga Dethlefsen, Eva Freyhult, Bengt Sennblad, Payam Emami" />


<meta name="date" content="2020-11-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="classification-with-knn-and-decision-trees.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to biostatistics and machine learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preliminary Mathematics</b></span></li>
<li class="chapter" data-level="1" data-path="mathematical-notations.html"><a href="mathematical-notations.html"><i class="fa fa-check"></i><b>1</b> Mathematical notations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mathematical-notations.html"><a href="mathematical-notations.html#numbers"><i class="fa fa-check"></i><b>1.1</b> Numbers</a></li>
<li class="chapter" data-level="1.2" data-path="mathematical-notations.html"><a href="mathematical-notations.html#variables-constants-and-letters"><i class="fa fa-check"></i><b>1.2</b> Variables, constants and letters</a></li>
<li class="chapter" data-level="1.3" data-path="mathematical-notations.html"><a href="mathematical-notations.html#a-precise-language"><i class="fa fa-check"></i><b>1.3</b> A precise language</a></li>
<li class="chapter" data-level="1.4" data-path="mathematical-notations.html"><a href="mathematical-notations.html#using-symbols"><i class="fa fa-check"></i><b>1.4</b> Using symbols</a></li>
<li class="chapter" data-level="1.5" data-path="mathematical-notations.html"><a href="mathematical-notations.html#inequalities"><i class="fa fa-check"></i><b>1.5</b> Inequalities</a></li>
<li class="chapter" data-level="1.6" data-path="mathematical-notations.html"><a href="mathematical-notations.html#indices-and-powers"><i class="fa fa-check"></i><b>1.6</b> Indices and powers</a></li>
<li class="chapter" data-level="1.7" data-path="mathematical-notations.html"><a href="mathematical-notations.html#exercises-notations"><i class="fa fa-check"></i><b>1.7</b> Exercises: notations</a></li>
<li class="chapter" data-level="" data-path="mathematical-notations.html"><a href="mathematical-notations.html#answers-to-selected-exercises-notations"><i class="fa fa-check"></i>Answers to selected exercises (notations)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sets.html"><a href="sets.html"><i class="fa fa-check"></i><b>2</b> Sets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sets.html"><a href="sets.html#definitions"><i class="fa fa-check"></i><b>2.1</b> Definitions</a></li>
<li class="chapter" data-level="2.2" data-path="sets.html"><a href="sets.html#basic-set-operations"><i class="fa fa-check"></i><b>2.2</b> Basic set operations</a></li>
<li class="chapter" data-level="2.3" data-path="sets.html"><a href="sets.html#venn-diagrams"><i class="fa fa-check"></i><b>2.3</b> Venn diagrams</a></li>
<li class="chapter" data-level="2.4" data-path="sets.html"><a href="sets.html#exercises-sets"><i class="fa fa-check"></i><b>2.4</b> Exercises: sets</a></li>
<li class="chapter" data-level="" data-path="sets.html"><a href="sets.html#answers-to-selected-exercises-sets"><i class="fa fa-check"></i>Answers to selected exercises (sets)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sets.html"><a href="sets.html#definitions"><i class="fa fa-check"></i><b>3.1</b> Definitions</a></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#evaluating-function"><i class="fa fa-check"></i><b>3.2</b> Evaluating function</a></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html#plotting-function"><i class="fa fa-check"></i><b>3.3</b> Plotting function</a></li>
<li class="chapter" data-level="3.4" data-path="functions.html"><a href="functions.html#standard-classes-of-functions"><i class="fa fa-check"></i><b>3.4</b> Standard classes of functions</a></li>
<li class="chapter" data-level="3.5" data-path="functions.html"><a href="functions.html#piecewise-functions"><i class="fa fa-check"></i><b>3.5</b> Piecewise functions</a></li>
<li class="chapter" data-level="3.6" data-path="functions.html"><a href="functions.html#exercises-functions"><i class="fa fa-check"></i><b>3.6</b> Exercises: functions</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#answers-to-selected-exercises-functions"><i class="fa fa-check"></i>Answers to selected exercises (functions)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="differentiation.html"><a href="differentiation.html"><i class="fa fa-check"></i><b>4</b> Differentiation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="differentiation.html"><a href="differentiation.html#rate-of-change"><i class="fa fa-check"></i><b>4.1</b> Rate of change</a></li>
<li class="chapter" data-level="4.2" data-path="differentiation.html"><a href="differentiation.html#average-rate-of-change-across-an-interval"><i class="fa fa-check"></i><b>4.2</b> Average rate of change across an interval</a></li>
<li class="chapter" data-level="4.3" data-path="differentiation.html"><a href="differentiation.html#rate-of-change-at-a-point"><i class="fa fa-check"></i><b>4.3</b> Rate of change at a point</a></li>
<li class="chapter" data-level="4.4" data-path="differentiation.html"><a href="differentiation.html#terminology-and-notation"><i class="fa fa-check"></i><b>4.4</b> Terminology and notation</a></li>
<li class="chapter" data-level="4.5" data-path="differentiation.html"><a href="differentiation.html#table-of-derivatives"><i class="fa fa-check"></i><b>4.5</b> Table of derivatives</a></li>
<li class="chapter" data-level="4.6" data-path="differentiation.html"><a href="differentiation.html#exercises-differentiation"><i class="fa fa-check"></i><b>4.6</b> Exercises (differentiation)</a></li>
<li class="chapter" data-level="" data-path="differentiation.html"><a href="differentiation.html#answers-to-selected-exercises-differentiation"><i class="fa fa-check"></i>Answers to selected exercises (differentiation)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="integration.html"><a href="integration.html"><i class="fa fa-check"></i><b>5</b> Integration</a>
<ul>
<li class="chapter" data-level="5.1" data-path="integration.html"><a href="integration.html#reverse-to-differentiation"><i class="fa fa-check"></i><b>5.1</b> Reverse to differentiation</a></li>
<li class="chapter" data-level="5.2" data-path="integration.html"><a href="integration.html#what-is-constant-of-integration"><i class="fa fa-check"></i><b>5.2</b> What is constant of integration?</a></li>
<li class="chapter" data-level="5.3" data-path="integration.html"><a href="integration.html#table-of-integrals"><i class="fa fa-check"></i><b>5.3</b> Table of integrals</a></li>
<li class="chapter" data-level="5.4" data-path="integration.html"><a href="integration.html#definite-integrals"><i class="fa fa-check"></i><b>5.4</b> Definite integrals</a></li>
<li class="chapter" data-level="5.5" data-path="integration.html"><a href="integration.html#exercises-integration"><i class="fa fa-check"></i><b>5.5</b> Exercises (integration)</a></li>
<li class="chapter" data-level="" data-path="integration.html"><a href="integration.html#answers-to-selected-exercises-integration"><i class="fa fa-check"></i>Answers to selected exercises (integration)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>6</b> Vectors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="vectors.html"><a href="vectors.html#vectors-1"><i class="fa fa-check"></i><b>6.1</b> Vectors</a></li>
<li class="chapter" data-level="6.2" data-path="vectors.html"><a href="vectors.html#operations-on-vectors"><i class="fa fa-check"></i><b>6.2</b> Operations on vectors</a></li>
<li class="chapter" data-level="6.3" data-path="vectors.html"><a href="vectors.html#null-and-unit-vector"><i class="fa fa-check"></i><b>6.3</b> Null and unit vector</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#answers-to-selected-exercises-vectors-and-matrices"><i class="fa fa-check"></i>Answers to selected exercises (vectors and matrices)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="matrices.html"><a href="matrices.html"><i class="fa fa-check"></i><b>7</b> Matrices</a>
<ul>
<li class="chapter" data-level="7.1" data-path="matrices.html"><a href="matrices.html#matrix"><i class="fa fa-check"></i><b>7.1</b> Matrix</a></li>
<li class="chapter" data-level="7.2" data-path="matrices.html"><a href="matrices.html#special-matrices"><i class="fa fa-check"></i><b>7.2</b> Special matrices</a></li>
<li class="chapter" data-level="7.3" data-path="matrices.html"><a href="matrices.html#matrix-operations"><i class="fa fa-check"></i><b>7.3</b> Matrix operations</a></li>
<li class="chapter" data-level="7.4" data-path="matrices.html"><a href="matrices.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>7.4</b> Inverse of a matrix</a></li>
<li class="chapter" data-level="7.5" data-path="matrices.html"><a href="matrices.html#orthogonal-matrix"><i class="fa fa-check"></i><b>7.5</b> Orthogonal matrix</a></li>
<li class="chapter" data-level="" data-path="matrices.html"><a href="matrices.html#answers-to-selected-exercises-matrices"><i class="fa fa-check"></i>Answers to selected exercises (matrices)</a></li>
</ul></li>
<li class="part"><span><b>II Linear Models</b></span></li>
<li class="chapter" data-level="8" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html"><i class="fa fa-check"></i><b>8</b> Introduction to linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#statistical-vs.-deterministic-relationship"><i class="fa fa-check"></i><b>8.1</b> Statistical vs.Â deterministic relationship</a></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#what-linear-models-are-and-are-not"><i class="fa fa-check"></i><b>8.2</b> What linear models are and are not</a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#terminology"><i class="fa fa-check"></i><b>8.3</b> Terminology</a></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#with-linear-models-we-can-answer-questions-such-as"><i class="fa fa-check"></i><b>8.4</b> With linear models we can answer questions such as:</a></li>
<li class="chapter" data-level="8.5" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.5</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.6" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#least-squares"><i class="fa fa-check"></i><b>8.6</b> Least squares</a></li>
<li class="chapter" data-level="8.7" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#intercept-and-slope"><i class="fa fa-check"></i><b>8.7</b> Intercept and Slope</a></li>
<li class="chapter" data-level="8.8" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>8.8</b> Hypothesis testing</a></li>
<li class="chapter" data-level="8.9" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#vector-matrix-notations"><i class="fa fa-check"></i><b>8.9</b> Vector-matrix notations</a></li>
<li class="chapter" data-level="8.10" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#confidence-intervals-and-prediction-intervals"><i class="fa fa-check"></i><b>8.10</b> Confidence intervals and prediction intervals</a></li>
<li class="chapter" data-level="8.11" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#exercises-linear-models-i"><i class="fa fa-check"></i><b>8.11</b> Exercises: linear models I</a></li>
<li class="chapter" data-level="" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#answers-to-selected-exercises-linear-models"><i class="fa fa-check"></i>Answers to selected exercises (linear models)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression-coefficients.html"><a href="regression-coefficients.html"><i class="fa fa-check"></i><b>9</b> Regression coefficients</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression-coefficients.html"><a href="regression-coefficients.html#interpreting-and-using-linear-regression-models"><i class="fa fa-check"></i><b>9.1</b> Interpreting and using linear regression models</a></li>
<li class="chapter" data-level="9.2" data-path="regression-coefficients.html"><a href="regression-coefficients.html#example-plasma-volume"><i class="fa fa-check"></i><b>9.2</b> Example: plasma volume</a></li>
<li class="chapter" data-level="9.3" data-path="regression-coefficients.html"><a href="regression-coefficients.html#example-galapagos-islands"><i class="fa fa-check"></i><b>9.3</b> Example: Galapagos Islands</a></li>
<li class="chapter" data-level="9.4" data-path="regression-coefficients.html"><a href="regression-coefficients.html#example-height-and-gender"><i class="fa fa-check"></i><b>9.4</b> Example: Height and gender</a></li>
<li class="chapter" data-level="9.5" data-path="regression-coefficients.html"><a href="regression-coefficients.html#example-heigth-weight-and-gender-i"><i class="fa fa-check"></i><b>9.5</b> Example: Heigth, weight and gender I</a></li>
<li class="chapter" data-level="9.6" data-path="regression-coefficients.html"><a href="regression-coefficients.html#example-heigth-weight-and-gender-ii"><i class="fa fa-check"></i><b>9.6</b> Example: Heigth, weight and gender II</a></li>
<li class="chapter" data-level="9.7" data-path="regression-coefficients.html"><a href="regression-coefficients.html#exercises-linear-models-ii"><i class="fa fa-check"></i><b>9.7</b> Exercises: linear models II</a></li>
<li class="chapter" data-level="" data-path="regression-coefficients.html"><a href="regression-coefficients.html#answers-to-selected-exercises-linear-models-ii"><i class="fa fa-check"></i>Answers to selected exercises (linear models II)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html"><i class="fa fa-check"></i><b>10</b> Model summary &amp; assumptions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#assessing-model-fit"><i class="fa fa-check"></i><b>10.1</b> Assessing model fit</a></li>
<li class="chapter" data-level="10.2" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#r2-summary-of-the-fitted-model"><i class="fa fa-check"></i><b>10.2</b> <span class="math inline">\(R^2\)</span>: summary of the fitted model</a></li>
<li class="chapter" data-level="10.3" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#r2-and-correlation-coefficient"><i class="fa fa-check"></i><b>10.3</b> <span class="math inline">\(R^2\)</span> and correlation coefficient</a></li>
<li class="chapter" data-level="10.4" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#r2adj"><i class="fa fa-check"></i><b>10.4</b> <span class="math inline">\(R^2(adj)\)</span></a></li>
<li class="chapter" data-level="10.5" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#the-assumptions-of-a-linear-model"><i class="fa fa-check"></i><b>10.5</b> The assumptions of a linear model</a></li>
<li class="chapter" data-level="10.6" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#checking-assumptions"><i class="fa fa-check"></i><b>10.6</b> Checking assumptions</a></li>
<li class="chapter" data-level="10.7" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#influential-observations"><i class="fa fa-check"></i><b>10.7</b> Influential observations</a></li>
<li class="chapter" data-level="10.8" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#exercises-linear-models-iii"><i class="fa fa-check"></i><b>10.8</b> Exercises: linear models III</a></li>
<li class="chapter" data-level="" data-path="model-summary-assumptions.html"><a href="model-summary-assumptions.html#answers-to-selected-exercises-linear-models-iii"><i class="fa fa-check"></i>Answers to selected exercises (linear models III)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>11</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#why-generalized-linear-models-glms"><i class="fa fa-check"></i><b>11.1</b> Why Generalized Linear Models (GLMs)</a></li>
<li class="chapter" data-level="11.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#warm-up"><i class="fa fa-check"></i><b>11.2</b> Warm-up</a></li>
<li class="chapter" data-level="11.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#logisitc-regression"><i class="fa fa-check"></i><b>11.3</b> Logisitc regression</a></li>
<li class="chapter" data-level="11.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>11.4</b> Poisson regression</a></li>
<li class="chapter" data-level="11.5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#exercises-glms"><i class="fa fa-check"></i><b>11.5</b> Exercises (GLMs)</a></li>
</ul></li>
<li class="part"><span><b>III Misc</b></span></li>
<li class="chapter" data-level="12" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html"><i class="fa fa-check"></i><b>12</b> Classification with knn and decision trees</a>
<ul>
<li class="chapter" data-level="12.1" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#classification"><i class="fa fa-check"></i><b>12.1</b> Classification</a></li>
<li class="chapter" data-level="12.2" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#evaluating-classification-model-performance"><i class="fa fa-check"></i><b>12.2</b> Evaluating Classification Model Performance</a></li>
<li class="chapter" data-level="12.3" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#data-splitting"><i class="fa fa-check"></i><b>12.3</b> Data splitting</a></li>
<li class="chapter" data-level="12.4" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#cross-validation"><i class="fa fa-check"></i><b>12.4</b> Cross validation</a></li>
<li class="chapter" data-level="12.5" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#k-nearest-neighbours"><i class="fa fa-check"></i><b>12.5</b> k-nearest neighbours</a></li>
<li class="chapter" data-level="12.6" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#classification-trees"><i class="fa fa-check"></i><b>12.6</b> Classification trees</a></li>
<li class="chapter" data-level="12.7" data-path="classification-with-knn-and-decision-trees.html"><a href="classification-with-knn-and-decision-trees.html#exercises-classification"><i class="fa fa-check"></i><b>12.7</b> Exercises: classification</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html"><i class="fa fa-check"></i><b>13</b> ANN regression and classification</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#exercise-1.1"><i class="fa fa-check"></i><b>13.1</b> Exercise 1.1</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#set-up"><i class="fa fa-check"></i><b>13.1.1</b> Set-up</a></li>
<li class="chapter" data-level="13.1.2" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#load-and-process-the-data"><i class="fa fa-check"></i><b>13.1.2</b> Load and process the data</a></li>
<li class="chapter" data-level="13.1.3" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#data-split"><i class="fa fa-check"></i><b>13.1.3</b> Data split</a></li>
<li class="chapter" data-level="13.1.4" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#default-knn-decision-tree-and-logistic-regression-classification"><i class="fa fa-check"></i><b>13.1.4</b> Default knn, decision tree and logistic regression classification</a></li>
<li class="chapter" data-level="13.1.5" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-classification-fitting-model"><i class="fa fa-check"></i><b>13.1.5</b> ANN classification: fitting model</a></li>
<li class="chapter" data-level="13.1.6" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-classification-comparing-to-logistic-regression"><i class="fa fa-check"></i><b>13.1.6</b> ANN classification: comparing to logistic regression</a></li>
<li class="chapter" data-level="13.1.7" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-classification-adding-hidden-layers"><i class="fa fa-check"></i><b>13.1.7</b> ANN classification: adding hidden layers</a></li>
<li class="chapter" data-level="13.1.8" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-classification-changing-activation-function"><i class="fa fa-check"></i><b>13.1.8</b> ANN classification: changing activation function</a></li>
<li class="chapter" data-level="13.1.9" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-regression"><i class="fa fa-check"></i><b>13.1.9</b> ANN regression</a></li>
<li class="chapter" data-level="13.1.10" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-rep-value"><i class="fa fa-check"></i><b>13.1.10</b> ANN rep value</a></li>
<li class="chapter" data-level="13.1.11" data-path="ann-regression-and-classification.html"><a href="ann-regression-and-classification.html#ann-relative-importance-of-variables"><i class="fa fa-check"></i><b>13.1.11</b> ANN relative importance of variables</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to biostatistics and machine learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ann-regression-and-classification" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> ANN regression and classification</h1>
<p><strong>Aims</strong></p>
<ul>
<li>to introduce regression and classification with ANN via examples</li>
</ul>
<p><strong>Learning outcomes</strong></p>
<ul>
<li>to be able to use neuralnet() package for classification and regression</li>
</ul>
<div id="exercise-1.1" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Exercise 1.1</h2>
<div id="set-up" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Set-up</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="ann-regression-and-classification.html#cb66-1" aria-hidden="true"></a><span class="co"># Clean all variables and load libraries</span></span>
<span id="cb66-2"><a href="ann-regression-and-classification.html#cb66-2" aria-hidden="true"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb66-3"><a href="ann-regression-and-classification.html#cb66-3" aria-hidden="true"></a><span class="kw">library</span>(mlbench) <span class="co"># CancerBreast dataset</span></span>
<span id="cb66-4"><a href="ann-regression-and-classification.html#cb66-4" aria-hidden="true"></a><span class="kw">library</span>(class) <span class="co"># knn</span></span>
<span id="cb66-5"><a href="ann-regression-and-classification.html#cb66-5" aria-hidden="true"></a><span class="kw">library</span>(rpart) <span class="co"># decision tree</span></span>
<span id="cb66-6"><a href="ann-regression-and-classification.html#cb66-6" aria-hidden="true"></a><span class="kw">library</span>(rpart.plot) <span class="co"># decision tree plots</span></span>
<span id="cb66-7"><a href="ann-regression-and-classification.html#cb66-7" aria-hidden="true"></a><span class="kw">library</span>(neuralnet) <span class="co"># ann</span></span>
<span id="cb66-8"><a href="ann-regression-and-classification.html#cb66-8" aria-hidden="true"></a><span class="kw">library</span>(NeuralNetTools) <span class="co"># ann tools</span></span>
<span id="cb66-9"><a href="ann-regression-and-classification.html#cb66-9" aria-hidden="true"></a><span class="kw">library</span>(ggplot2) <span class="co"># plotting</span></span>
<span id="cb66-10"><a href="ann-regression-and-classification.html#cb66-10" aria-hidden="true"></a><span class="kw">library</span>(ggiraphExtra)</span></code></pre></div>
</div>
<div id="load-and-process-the-data" class="section level3" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Load and process the data</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ann-regression-and-classification.html#cb67-1" aria-hidden="true"></a><span class="co"># Data input </span></span>
<span id="cb67-2"><a href="ann-regression-and-classification.html#cb67-2" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>)</span>
<span id="cb67-3"><a href="ann-regression-and-classification.html#cb67-3" aria-hidden="true"></a><span class="kw">head</span>(BreastCancer) <span class="co"># preview data</span></span>
<span id="cb67-4"><a href="ann-regression-and-classification.html#cb67-4" aria-hidden="true"></a><span class="co">##        Id Cl.thickness Cell.size Cell.shape Marg.adhesion Epith.c.size</span></span>
<span id="cb67-5"><a href="ann-regression-and-classification.html#cb67-5" aria-hidden="true"></a><span class="co">## 1 1000025            5         1          1             1            2</span></span>
<span id="cb67-6"><a href="ann-regression-and-classification.html#cb67-6" aria-hidden="true"></a><span class="co">## 2 1002945            5         4          4             5            7</span></span>
<span id="cb67-7"><a href="ann-regression-and-classification.html#cb67-7" aria-hidden="true"></a><span class="co">## 3 1015425            3         1          1             1            2</span></span>
<span id="cb67-8"><a href="ann-regression-and-classification.html#cb67-8" aria-hidden="true"></a><span class="co">## 4 1016277            6         8          8             1            3</span></span>
<span id="cb67-9"><a href="ann-regression-and-classification.html#cb67-9" aria-hidden="true"></a><span class="co">## 5 1017023            4         1          1             3            2</span></span>
<span id="cb67-10"><a href="ann-regression-and-classification.html#cb67-10" aria-hidden="true"></a><span class="co">## 6 1017122            8        10         10             8            7</span></span>
<span id="cb67-11"><a href="ann-regression-and-classification.html#cb67-11" aria-hidden="true"></a><span class="co">##   Bare.nuclei Bl.cromatin Normal.nucleoli Mitoses     Class</span></span>
<span id="cb67-12"><a href="ann-regression-and-classification.html#cb67-12" aria-hidden="true"></a><span class="co">## 1           1           3               1       1    benign</span></span>
<span id="cb67-13"><a href="ann-regression-and-classification.html#cb67-13" aria-hidden="true"></a><span class="co">## 2          10           3               2       1    benign</span></span>
<span id="cb67-14"><a href="ann-regression-and-classification.html#cb67-14" aria-hidden="true"></a><span class="co">## 3           2           3               1       1    benign</span></span>
<span id="cb67-15"><a href="ann-regression-and-classification.html#cb67-15" aria-hidden="true"></a><span class="co">## 4           4           3               7       1    benign</span></span>
<span id="cb67-16"><a href="ann-regression-and-classification.html#cb67-16" aria-hidden="true"></a><span class="co">## 5           1           3               1       1    benign</span></span>
<span id="cb67-17"><a href="ann-regression-and-classification.html#cb67-17" aria-hidden="true"></a><span class="co">## 6          10           9               7       1 malignant</span></span>
<span id="cb67-18"><a href="ann-regression-and-classification.html#cb67-18" aria-hidden="true"></a><span class="kw">str</span>(BreastCancer) <span class="co"># show data types</span></span>
<span id="cb67-19"><a href="ann-regression-and-classification.html#cb67-19" aria-hidden="true"></a><span class="co">## &#39;data.frame&#39;:	699 obs. of  11 variables:</span></span>
<span id="cb67-20"><a href="ann-regression-and-classification.html#cb67-20" aria-hidden="true"></a><span class="co">##  $ Id             : chr  &quot;1000025&quot; &quot;1002945&quot; &quot;1015425&quot; &quot;1016277&quot; ...</span></span>
<span id="cb67-21"><a href="ann-regression-and-classification.html#cb67-21" aria-hidden="true"></a><span class="co">##  $ Cl.thickness   : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 5 5 3 6 4 8 1 2 2 4 ...</span></span>
<span id="cb67-22"><a href="ann-regression-and-classification.html#cb67-22" aria-hidden="true"></a><span class="co">##  $ Cell.size      : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 4 1 8 1 10 1 1 1 2 ...</span></span>
<span id="cb67-23"><a href="ann-regression-and-classification.html#cb67-23" aria-hidden="true"></a><span class="co">##  $ Cell.shape     : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 4 1 8 1 10 1 2 1 1 ...</span></span>
<span id="cb67-24"><a href="ann-regression-and-classification.html#cb67-24" aria-hidden="true"></a><span class="co">##  $ Marg.adhesion  : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 5 1 1 3 8 1 1 1 1 ...</span></span>
<span id="cb67-25"><a href="ann-regression-and-classification.html#cb67-25" aria-hidden="true"></a><span class="co">##  $ Epith.c.size   : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 2 7 2 3 2 7 2 2 2 2 ...</span></span>
<span id="cb67-26"><a href="ann-regression-and-classification.html#cb67-26" aria-hidden="true"></a><span class="co">##  $ Bare.nuclei    : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 10 2 4 1 10 10 1 1 1 ...</span></span>
<span id="cb67-27"><a href="ann-regression-and-classification.html#cb67-27" aria-hidden="true"></a><span class="co">##  $ Bl.cromatin    : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 3 3 3 3 3 9 3 3 1 2 ...</span></span>
<span id="cb67-28"><a href="ann-regression-and-classification.html#cb67-28" aria-hidden="true"></a><span class="co">##  $ Normal.nucleoli: Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 1 7 1 7 1 1 1 1 ...</span></span>
<span id="cb67-29"><a href="ann-regression-and-classification.html#cb67-29" aria-hidden="true"></a><span class="co">##  $ Mitoses        : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 5 1 ...</span></span>
<span id="cb67-30"><a href="ann-regression-and-classification.html#cb67-30" aria-hidden="true"></a><span class="co">##  $ Class          : Factor w/ 2 levels &quot;benign&quot;,&quot;malignant&quot;: 1 1 1 1 1 2 1 1 1 1 ...</span></span>
<span id="cb67-31"><a href="ann-regression-and-classification.html#cb67-31" aria-hidden="true"></a></span>
<span id="cb67-32"><a href="ann-regression-and-classification.html#cb67-32" aria-hidden="true"></a><span class="co"># data summary</span></span>
<span id="cb67-33"><a href="ann-regression-and-classification.html#cb67-33" aria-hidden="true"></a><span class="kw">summary</span>(BreastCancer)</span>
<span id="cb67-34"><a href="ann-regression-and-classification.html#cb67-34" aria-hidden="true"></a><span class="co">##       Id             Cl.thickness   Cell.size     Cell.shape  Marg.adhesion</span></span>
<span id="cb67-35"><a href="ann-regression-and-classification.html#cb67-35" aria-hidden="true"></a><span class="co">##  Length:699         1      :145   1      :384   1      :353   1      :407  </span></span>
<span id="cb67-36"><a href="ann-regression-and-classification.html#cb67-36" aria-hidden="true"></a><span class="co">##  Class :character   5      :130   10     : 67   2      : 59   2      : 58  </span></span>
<span id="cb67-37"><a href="ann-regression-and-classification.html#cb67-37" aria-hidden="true"></a><span class="co">##  Mode  :character   3      :108   3      : 52   10     : 58   3      : 58  </span></span>
<span id="cb67-38"><a href="ann-regression-and-classification.html#cb67-38" aria-hidden="true"></a><span class="co">##                     4      : 80   2      : 45   3      : 56   10     : 55  </span></span>
<span id="cb67-39"><a href="ann-regression-and-classification.html#cb67-39" aria-hidden="true"></a><span class="co">##                     10     : 69   4      : 40   4      : 44   4      : 33  </span></span>
<span id="cb67-40"><a href="ann-regression-and-classification.html#cb67-40" aria-hidden="true"></a><span class="co">##                     2      : 50   5      : 30   5      : 34   8      : 25  </span></span>
<span id="cb67-41"><a href="ann-regression-and-classification.html#cb67-41" aria-hidden="true"></a><span class="co">##                     (Other):117   (Other): 81   (Other): 95   (Other): 63  </span></span>
<span id="cb67-42"><a href="ann-regression-and-classification.html#cb67-42" aria-hidden="true"></a><span class="co">##   Epith.c.size  Bare.nuclei   Bl.cromatin  Normal.nucleoli    Mitoses   </span></span>
<span id="cb67-43"><a href="ann-regression-and-classification.html#cb67-43" aria-hidden="true"></a><span class="co">##  2      :386   1      :402   2      :166   1      :443     1      :579  </span></span>
<span id="cb67-44"><a href="ann-regression-and-classification.html#cb67-44" aria-hidden="true"></a><span class="co">##  3      : 72   10     :132   3      :165   10     : 61     2      : 35  </span></span>
<span id="cb67-45"><a href="ann-regression-and-classification.html#cb67-45" aria-hidden="true"></a><span class="co">##  4      : 48   2      : 30   1      :152   3      : 44     3      : 33  </span></span>
<span id="cb67-46"><a href="ann-regression-and-classification.html#cb67-46" aria-hidden="true"></a><span class="co">##  1      : 47   5      : 30   7      : 73   2      : 36     10     : 14  </span></span>
<span id="cb67-47"><a href="ann-regression-and-classification.html#cb67-47" aria-hidden="true"></a><span class="co">##  6      : 41   3      : 28   4      : 40   8      : 24     4      : 12  </span></span>
<span id="cb67-48"><a href="ann-regression-and-classification.html#cb67-48" aria-hidden="true"></a><span class="co">##  5      : 39   (Other): 61   5      : 34   6      : 22     7      :  9  </span></span>
<span id="cb67-49"><a href="ann-regression-and-classification.html#cb67-49" aria-hidden="true"></a><span class="co">##  (Other): 66   NA&#39;s   : 16   (Other): 69   (Other): 69     (Other): 17  </span></span>
<span id="cb67-50"><a href="ann-regression-and-classification.html#cb67-50" aria-hidden="true"></a><span class="co">##        Class    </span></span>
<span id="cb67-51"><a href="ann-regression-and-classification.html#cb67-51" aria-hidden="true"></a><span class="co">##  benign   :458  </span></span>
<span id="cb67-52"><a href="ann-regression-and-classification.html#cb67-52" aria-hidden="true"></a><span class="co">##  malignant:241  </span></span>
<span id="cb67-53"><a href="ann-regression-and-classification.html#cb67-53" aria-hidden="true"></a><span class="co">##                 </span></span>
<span id="cb67-54"><a href="ann-regression-and-classification.html#cb67-54" aria-hidden="true"></a><span class="co">##                 </span></span>
<span id="cb67-55"><a href="ann-regression-and-classification.html#cb67-55" aria-hidden="true"></a><span class="co">##                 </span></span>
<span id="cb67-56"><a href="ann-regression-and-classification.html#cb67-56" aria-hidden="true"></a><span class="co">##                 </span></span>
<span id="cb67-57"><a href="ann-regression-and-classification.html#cb67-57" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb67-58"><a href="ann-regression-and-classification.html#cb67-58" aria-hidden="true"></a></span>
<span id="cb67-59"><a href="ann-regression-and-classification.html#cb67-59" aria-hidden="true"></a><span class="co"># convert variables to numerical values</span></span>
<span id="cb67-60"><a href="ann-regression-and-classification.html#cb67-60" aria-hidden="true"></a>data.breast &lt;-<span class="st"> </span>BreastCancer</span>
<span id="cb67-61"><a href="ann-regression-and-classification.html#cb67-61" aria-hidden="true"></a>data.breast &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Class =</span> BreastCancer<span class="op">$</span>Class,</span>
<span id="cb67-62"><a href="ann-regression-and-classification.html#cb67-62" aria-hidden="true"></a>                          <span class="dt">Cell.size =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Cell.size),</span>
<span id="cb67-63"><a href="ann-regression-and-classification.html#cb67-63" aria-hidden="true"></a>                          <span class="dt">Cell.shape =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Cell.shape), </span>
<span id="cb67-64"><a href="ann-regression-and-classification.html#cb67-64" aria-hidden="true"></a>                          <span class="dt">Cl.thickness =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Cl.thickness),</span>
<span id="cb67-65"><a href="ann-regression-and-classification.html#cb67-65" aria-hidden="true"></a>                          <span class="dt">Marg.adhesion =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Marg.adhesion),</span>
<span id="cb67-66"><a href="ann-regression-and-classification.html#cb67-66" aria-hidden="true"></a>                          <span class="dt">Epith.c.size =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Epith.c.size), </span>
<span id="cb67-67"><a href="ann-regression-and-classification.html#cb67-67" aria-hidden="true"></a>                          <span class="dt">Bare.nuclei =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Bare.nuclei),</span>
<span id="cb67-68"><a href="ann-regression-and-classification.html#cb67-68" aria-hidden="true"></a>                          <span class="dt">Bl.cromatin =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Bare.nuclei),</span>
<span id="cb67-69"><a href="ann-regression-and-classification.html#cb67-69" aria-hidden="true"></a>                          <span class="dt">Normal.nucleoli =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Normal.nucleoli), </span>
<span id="cb67-70"><a href="ann-regression-and-classification.html#cb67-70" aria-hidden="true"></a>                          <span class="dt">Mitoses =</span> <span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Mitoses)</span>
<span id="cb67-71"><a href="ann-regression-and-classification.html#cb67-71" aria-hidden="true"></a>                          )</span>
<span id="cb67-72"><a href="ann-regression-and-classification.html#cb67-72" aria-hidden="true"></a></span>
<span id="cb67-73"><a href="ann-regression-and-classification.html#cb67-73" aria-hidden="true"></a><span class="kw">str</span>(data.breast)</span>
<span id="cb67-74"><a href="ann-regression-and-classification.html#cb67-74" aria-hidden="true"></a><span class="co">## &#39;data.frame&#39;:	699 obs. of  10 variables:</span></span>
<span id="cb67-75"><a href="ann-regression-and-classification.html#cb67-75" aria-hidden="true"></a><span class="co">##  $ Class          : Factor w/ 2 levels &quot;benign&quot;,&quot;malignant&quot;: 1 1 1 1 1 2 1 1 1 1 ...</span></span>
<span id="cb67-76"><a href="ann-regression-and-classification.html#cb67-76" aria-hidden="true"></a><span class="co">##  $ Cell.size      : num  1 4 1 8 1 10 1 1 1 2 ...</span></span>
<span id="cb67-77"><a href="ann-regression-and-classification.html#cb67-77" aria-hidden="true"></a><span class="co">##  $ Cell.shape     : num  1 4 1 8 1 10 1 2 1 1 ...</span></span>
<span id="cb67-78"><a href="ann-regression-and-classification.html#cb67-78" aria-hidden="true"></a><span class="co">##  $ Cl.thickness   : num  5 5 3 6 4 8 1 2 2 4 ...</span></span>
<span id="cb67-79"><a href="ann-regression-and-classification.html#cb67-79" aria-hidden="true"></a><span class="co">##  $ Marg.adhesion  : num  1 5 1 1 3 8 1 1 1 1 ...</span></span>
<span id="cb67-80"><a href="ann-regression-and-classification.html#cb67-80" aria-hidden="true"></a><span class="co">##  $ Epith.c.size   : num  2 7 2 3 2 7 2 2 2 2 ...</span></span>
<span id="cb67-81"><a href="ann-regression-and-classification.html#cb67-81" aria-hidden="true"></a><span class="co">##  $ Bare.nuclei    : num  1 10 2 4 1 10 10 1 1 1 ...</span></span>
<span id="cb67-82"><a href="ann-regression-and-classification.html#cb67-82" aria-hidden="true"></a><span class="co">##  $ Bl.cromatin    : num  1 10 2 4 1 10 10 1 1 1 ...</span></span>
<span id="cb67-83"><a href="ann-regression-and-classification.html#cb67-83" aria-hidden="true"></a><span class="co">##  $ Normal.nucleoli: num  1 2 1 7 1 7 1 1 1 1 ...</span></span>
<span id="cb67-84"><a href="ann-regression-and-classification.html#cb67-84" aria-hidden="true"></a><span class="co">##  $ Mitoses        : num  1 1 1 1 1 1 1 1 5 1 ...</span></span>
<span id="cb67-85"><a href="ann-regression-and-classification.html#cb67-85" aria-hidden="true"></a></span>
<span id="cb67-86"><a href="ann-regression-and-classification.html#cb67-86" aria-hidden="true"></a><span class="co"># Remove missing data</span></span>
<span id="cb67-87"><a href="ann-regression-and-classification.html#cb67-87" aria-hidden="true"></a>data.breast &lt;-<span class="st"> </span><span class="kw">na.omit</span>(data.breast)</span></code></pre></div>
</div>
<div id="data-split" class="section level3" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Data split</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="ann-regression-and-classification.html#cb68-1" aria-hidden="true"></a><span class="co"># Split into train, validation, test</span></span>
<span id="cb68-2"><a href="ann-regression-and-classification.html#cb68-2" aria-hidden="true"></a><span class="co"># split data into train 50%, validation 25% and test dataset 25%</span></span>
<span id="cb68-3"><a href="ann-regression-and-classification.html#cb68-3" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb68-4"><a href="ann-regression-and-classification.html#cb68-4" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(data.breast) <span class="co"># no. of observations</span></span>
<span id="cb68-5"><a href="ann-regression-and-classification.html#cb68-5" aria-hidden="true"></a>idx.train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n), <span class="kw">round</span>(n<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb68-6"><a href="ann-regression-and-classification.html#cb68-6" aria-hidden="true"></a>idx.valid &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>idx.train], <span class="kw">round</span>(n<span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb68-7"><a href="ann-regression-and-classification.html#cb68-7" aria-hidden="true"></a>idx.test &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n), <span class="kw">c</span>(idx.train, idx.valid))</span>
<span id="cb68-8"><a href="ann-regression-and-classification.html#cb68-8" aria-hidden="true"></a></span>
<span id="cb68-9"><a href="ann-regression-and-classification.html#cb68-9" aria-hidden="true"></a>data.train &lt;-<span class="st"> </span>data.breast[idx.train,]</span>
<span id="cb68-10"><a href="ann-regression-and-classification.html#cb68-10" aria-hidden="true"></a>data.valid &lt;-<span class="st"> </span>data.breast[idx.valid,]</span>
<span id="cb68-11"><a href="ann-regression-and-classification.html#cb68-11" aria-hidden="true"></a>data.test &lt;-<span class="st"> </span>data.breast[idx.test,]</span>
<span id="cb68-12"><a href="ann-regression-and-classification.html#cb68-12" aria-hidden="true"></a></span>
<span id="cb68-13"><a href="ann-regression-and-classification.html#cb68-13" aria-hidden="true"></a><span class="kw">dim</span>(data.train)</span>
<span id="cb68-14"><a href="ann-regression-and-classification.html#cb68-14" aria-hidden="true"></a><span class="co">## [1] 342  10</span></span>
<span id="cb68-15"><a href="ann-regression-and-classification.html#cb68-15" aria-hidden="true"></a><span class="kw">dim</span>(data.valid)</span>
<span id="cb68-16"><a href="ann-regression-and-classification.html#cb68-16" aria-hidden="true"></a><span class="co">## [1] 171  10</span></span>
<span id="cb68-17"><a href="ann-regression-and-classification.html#cb68-17" aria-hidden="true"></a><span class="kw">dim</span>(data.test)</span>
<span id="cb68-18"><a href="ann-regression-and-classification.html#cb68-18" aria-hidden="true"></a><span class="co">## [1] 170  10</span></span></code></pre></div>
</div>
<div id="default-knn-decision-tree-and-logistic-regression-classification" class="section level3" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> Default knn, decision tree and logistic regression classification</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ann-regression-and-classification.html#cb69-1" aria-hidden="true"></a><span class="co"># KNN (k=3)</span></span>
<span id="cb69-2"><a href="ann-regression-and-classification.html#cb69-2" aria-hidden="true"></a>knn.pred &lt;-<span class="st"> </span><span class="kw">knn</span>(<span class="dt">train =</span> data.train[, <span class="dv">-1</span>], data.test[, <span class="dv">-1</span>], data.train[,<span class="dv">1</span>], <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb69-3"><a href="ann-regression-and-classification.html#cb69-3" aria-hidden="true"></a>knn.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((knn.pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(knn.pred) <span class="co"># classification rate</span></span>
<span id="cb69-4"><a href="ann-regression-and-classification.html#cb69-4" aria-hidden="true"></a><span class="kw">print</span>(knn.cr)</span>
<span id="cb69-5"><a href="ann-regression-and-classification.html#cb69-5" aria-hidden="true"></a><span class="co">## [1] 0.9588235</span></span>
<span id="cb69-6"><a href="ann-regression-and-classification.html#cb69-6" aria-hidden="true"></a></span>
<span id="cb69-7"><a href="ann-regression-and-classification.html#cb69-7" aria-hidden="true"></a><span class="co"># Decision tree</span></span>
<span id="cb69-8"><a href="ann-regression-and-classification.html#cb69-8" aria-hidden="true"></a>cart<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">rpart</span>(data.train<span class="op">$</span>Class <span class="op">~</span><span class="st"> </span>Cl.thickness <span class="op">+</span><span class="st"> </span>Cell.size <span class="op">+</span><span class="st">  </span>Cell.shape <span class="op">+</span><span class="st"> </span>Marg.adhesion <span class="op">+</span><span class="st"> </span>Epith.c.size <span class="op">+</span><span class="st"> </span>Bare.nuclei <span class="op">+</span><span class="st"> </span>Bl.cromatin <span class="op">+</span><span class="st"> </span>Normal.nucleoli <span class="op">+</span><span class="st"> </span>Mitoses, <span class="dt">data=</span>data.train)</span>
<span id="cb69-9"><a href="ann-regression-and-classification.html#cb69-9" aria-hidden="true"></a><span class="kw">rpart.plot</span>(cart<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="402-ann-intro_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ann-regression-and-classification.html#cb70-1" aria-hidden="true"></a>cart.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(cart<span class="fl">.1</span>, <span class="dt">newdata =</span> data.test, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb70-2"><a href="ann-regression-and-classification.html#cb70-2" aria-hidden="true"></a>cart.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((cart.pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(cart.pred)</span>
<span id="cb70-3"><a href="ann-regression-and-classification.html#cb70-3" aria-hidden="true"></a><span class="kw">print</span>(cart.cr)</span>
<span id="cb70-4"><a href="ann-regression-and-classification.html#cb70-4" aria-hidden="true"></a><span class="co">## [1] 0.9352941</span></span>
<span id="cb70-5"><a href="ann-regression-and-classification.html#cb70-5" aria-hidden="true"></a></span>
<span id="cb70-6"><a href="ann-regression-and-classification.html#cb70-6" aria-hidden="true"></a><span class="co"># Logisitc regression</span></span>
<span id="cb70-7"><a href="ann-regression-and-classification.html#cb70-7" aria-hidden="true"></a>logreg &lt;-<span class="st"> </span><span class="kw">glm</span>(data.train<span class="op">$</span>Class <span class="op">~</span><span class="st"> </span>Cl.thickness <span class="op">+</span><span class="st"> </span>Cell.size <span class="op">+</span><span class="st">  </span>Cell.shape <span class="op">+</span><span class="st"> </span>Marg.adhesion <span class="op">+</span><span class="st"> </span>Epith.c.size <span class="op">+</span><span class="st"> </span>Bare.nuclei <span class="op">+</span><span class="st"> </span>Bl.cromatin <span class="op">+</span><span class="st"> </span>Normal.nucleoli <span class="op">+</span><span class="st"> </span>Mitoses, <span class="dt">data=</span>data.train, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb70-8"><a href="ann-regression-and-classification.html#cb70-8" aria-hidden="true"></a><span class="co">## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb70-9"><a href="ann-regression-and-classification.html#cb70-9" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">summary</span>(logreg))</span>
<span id="cb70-10"><a href="ann-regression-and-classification.html#cb70-10" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-11"><a href="ann-regression-and-classification.html#cb70-11" aria-hidden="true"></a><span class="co">## Call:</span></span>
<span id="cb70-12"><a href="ann-regression-and-classification.html#cb70-12" aria-hidden="true"></a><span class="co">## glm(formula = data.train$Class ~ Cl.thickness + Cell.size + Cell.shape + </span></span>
<span id="cb70-13"><a href="ann-regression-and-classification.html#cb70-13" aria-hidden="true"></a><span class="co">##     Marg.adhesion + Epith.c.size + Bare.nuclei + Bl.cromatin + </span></span>
<span id="cb70-14"><a href="ann-regression-and-classification.html#cb70-14" aria-hidden="true"></a><span class="co">##     Normal.nucleoli + Mitoses, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb70-15"><a href="ann-regression-and-classification.html#cb70-15" aria-hidden="true"></a><span class="co">##     data = data.train)</span></span>
<span id="cb70-16"><a href="ann-regression-and-classification.html#cb70-16" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-17"><a href="ann-regression-and-classification.html#cb70-17" aria-hidden="true"></a><span class="co">## Deviance Residuals: </span></span>
<span id="cb70-18"><a href="ann-regression-and-classification.html#cb70-18" aria-hidden="true"></a><span class="co">##      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb70-19"><a href="ann-regression-and-classification.html#cb70-19" aria-hidden="true"></a><span class="co">## -2.78015  -0.09873  -0.04989   0.00842   2.29108  </span></span>
<span id="cb70-20"><a href="ann-regression-and-classification.html#cb70-20" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-21"><a href="ann-regression-and-classification.html#cb70-21" aria-hidden="true"></a><span class="co">## Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb70-22"><a href="ann-regression-and-classification.html#cb70-22" aria-hidden="true"></a><span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb70-23"><a href="ann-regression-and-classification.html#cb70-23" aria-hidden="true"></a><span class="co">## (Intercept)     -10.8815     2.1472  -5.068 4.02e-07 ***</span></span>
<span id="cb70-24"><a href="ann-regression-and-classification.html#cb70-24" aria-hidden="true"></a><span class="co">## Cl.thickness      0.4050     0.2242   1.807 0.070827 .  </span></span>
<span id="cb70-25"><a href="ann-regression-and-classification.html#cb70-25" aria-hidden="true"></a><span class="co">## Cell.size         0.1039     0.2724   0.381 0.702933    </span></span>
<span id="cb70-26"><a href="ann-regression-and-classification.html#cb70-26" aria-hidden="true"></a><span class="co">## Cell.shape        0.6366     0.3678   1.731 0.083481 .  </span></span>
<span id="cb70-27"><a href="ann-regression-and-classification.html#cb70-27" aria-hidden="true"></a><span class="co">## Marg.adhesion     0.3343     0.1951   1.714 0.086534 .  </span></span>
<span id="cb70-28"><a href="ann-regression-and-classification.html#cb70-28" aria-hidden="true"></a><span class="co">## Epith.c.size     -0.4608     0.2947  -1.564 0.117860    </span></span>
<span id="cb70-29"><a href="ann-regression-and-classification.html#cb70-29" aria-hidden="true"></a><span class="co">## Bare.nuclei       0.5100     0.1525   3.343 0.000828 ***</span></span>
<span id="cb70-30"><a href="ann-regression-and-classification.html#cb70-30" aria-hidden="true"></a><span class="co">## Bl.cromatin           NA         NA      NA       NA    </span></span>
<span id="cb70-31"><a href="ann-regression-and-classification.html#cb70-31" aria-hidden="true"></a><span class="co">## Normal.nucleoli   0.5765     0.1944   2.966 0.003015 ** </span></span>
<span id="cb70-32"><a href="ann-regression-and-classification.html#cb70-32" aria-hidden="true"></a><span class="co">## Mitoses           2.3031     1.2862   1.791 0.073361 .  </span></span>
<span id="cb70-33"><a href="ann-regression-and-classification.html#cb70-33" aria-hidden="true"></a><span class="co">## ---</span></span>
<span id="cb70-34"><a href="ann-regression-and-classification.html#cb70-34" aria-hidden="true"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb70-35"><a href="ann-regression-and-classification.html#cb70-35" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-36"><a href="ann-regression-and-classification.html#cb70-36" aria-hidden="true"></a><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb70-37"><a href="ann-regression-and-classification.html#cb70-37" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-38"><a href="ann-regression-and-classification.html#cb70-38" aria-hidden="true"></a><span class="co">##     Null deviance: 457.974  on 341  degrees of freedom</span></span>
<span id="cb70-39"><a href="ann-regression-and-classification.html#cb70-39" aria-hidden="true"></a><span class="co">## Residual deviance:  40.942  on 333  degrees of freedom</span></span>
<span id="cb70-40"><a href="ann-regression-and-classification.html#cb70-40" aria-hidden="true"></a><span class="co">## AIC: 58.942</span></span>
<span id="cb70-41"><a href="ann-regression-and-classification.html#cb70-41" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb70-42"><a href="ann-regression-and-classification.html#cb70-42" aria-hidden="true"></a><span class="co">## Number of Fisher Scoring iterations: 9</span></span>
<span id="cb70-43"><a href="ann-regression-and-classification.html#cb70-43" aria-hidden="true"></a>logreg.prob &lt;-<span class="st"> </span><span class="kw">predict</span>(logreg, <span class="dt">newdata=</span>data.test, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb70-44"><a href="ann-regression-and-classification.html#cb70-44" aria-hidden="true"></a><span class="co">## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span id="cb70-45"><a href="ann-regression-and-classification.html#cb70-45" aria-hidden="true"></a><span class="co">## prediction from a rank-deficient fit may be misleading</span></span>
<span id="cb70-46"><a href="ann-regression-and-classification.html#cb70-46" aria-hidden="true"></a></span>
<span id="cb70-47"><a href="ann-regression-and-classification.html#cb70-47" aria-hidden="true"></a>logreg.pred &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;malignant&quot;</span>, <span class="kw">nrow</span>(data.test))</span>
<span id="cb70-48"><a href="ann-regression-and-classification.html#cb70-48" aria-hidden="true"></a>logreg.pred[logreg.prob <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>] &lt;-<span class="st"> &quot;benign&quot;</span></span>
<span id="cb70-49"><a href="ann-regression-and-classification.html#cb70-49" aria-hidden="true"></a>logreg.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((logreg.pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(logreg.pred)</span>
<span id="cb70-50"><a href="ann-regression-and-classification.html#cb70-50" aria-hidden="true"></a><span class="kw">print</span>(logreg.cr)</span>
<span id="cb70-51"><a href="ann-regression-and-classification.html#cb70-51" aria-hidden="true"></a><span class="co">## [1] 0.9411765</span></span>
<span id="cb70-52"><a href="ann-regression-and-classification.html#cb70-52" aria-hidden="true"></a></span>
<span id="cb70-53"><a href="ann-regression-and-classification.html#cb70-53" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(knn.cr, cart.cr, logreg.cr))</span>
<span id="cb70-54"><a href="ann-regression-and-classification.html#cb70-54" aria-hidden="true"></a><span class="co">## [1] 0.9588235 0.9352941 0.9411765</span></span></code></pre></div>
</div>
<div id="ann-classification-fitting-model" class="section level3" number="13.1.5">
<h3><span class="header-section-number">13.1.5</span> ANN classification: fitting model</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="ann-regression-and-classification.html#cb71-1" aria-hidden="true"></a><span class="co"># fit ANN classification model (default parameters and logistic activation function)</span></span>
<span id="cb71-2"><a href="ann-regression-and-classification.html#cb71-2" aria-hidden="true"></a><span class="co"># notice linear.output set to FALSE</span></span>
<span id="cb71-3"><a href="ann-regression-and-classification.html#cb71-3" aria-hidden="true"></a>ann.c1 &lt;-<span class="st"> </span><span class="kw">neuralnet</span>(Class <span class="op">~</span><span class="st"> </span>Cl.thickness <span class="op">+</span><span class="st"> </span>Cell.size <span class="op">+</span><span class="st">  </span>Cell.shape <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-4"><a href="ann-regression-and-classification.html#cb71-4" aria-hidden="true"></a><span class="st">                        </span>Marg.adhesion <span class="op">+</span><span class="st"> </span>Epith.c.size <span class="op">+</span><span class="st"> </span>Bare.nuclei <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-5"><a href="ann-regression-and-classification.html#cb71-5" aria-hidden="true"></a><span class="st">                        </span>Bl.cromatin <span class="op">+</span><span class="st"> </span>Normal.nucleoli <span class="op">+</span><span class="st"> </span>Mitoses, </span>
<span id="cb71-6"><a href="ann-regression-and-classification.html#cb71-6" aria-hidden="true"></a>                        <span class="dt">data=</span>data.train, </span>
<span id="cb71-7"><a href="ann-regression-and-classification.html#cb71-7" aria-hidden="true"></a>                        <span class="dt">linear.output =</span> <span class="ot">FALSE</span>, </span>
<span id="cb71-8"><a href="ann-regression-and-classification.html#cb71-8" aria-hidden="true"></a>                        <span class="dt">act.fct =</span> <span class="st">&quot;logistic&quot;</span>)</span>
<span id="cb71-9"><a href="ann-regression-and-classification.html#cb71-9" aria-hidden="true"></a></span>
<span id="cb71-10"><a href="ann-regression-and-classification.html#cb71-10" aria-hidden="true"></a><span class="kw">plotnet</span>(ann.c1, <span class="dt">cex_val =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ann-classification-fit"></span>
<img src="402-ann-intro_files/figure-html/ann-classification-fit-1.png" alt="ANN model representation. The black lines show the connections between each layer and the weights on each connection; B nodes represent bias terms added in each step (bias nodes), and the hidden nodes are the ones between the input and output, here only one node" width="672" />
<p class="caption">
Figure 13.1: ANN model representation. The black lines show the connections between each layer and the weights on each connection; B nodes represent bias terms added in each step (bias nodes), and the hidden nodes are the ones between the input and output, here only one node
</p>
</div>
</div>
<div id="ann-classification-comparing-to-logistic-regression" class="section level3" number="13.1.6">
<h3><span class="header-section-number">13.1.6</span> ANN classification: comparing to logistic regression</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ann-regression-and-classification.html#cb72-1" aria-hidden="true"></a><span class="co"># we run prediction using compute function()</span></span>
<span id="cb72-2"><a href="ann-regression-and-classification.html#cb72-2" aria-hidden="true"></a>ann.c1_predictions &lt;-<span class="st"> </span>neuralnet<span class="op">::</span><span class="kw">compute</span>(ann.c1, </span>
<span id="cb72-3"><a href="ann-regression-and-classification.html#cb72-3" aria-hidden="true"></a>                                  data.test)</span>
<span id="cb72-4"><a href="ann-regression-and-classification.html#cb72-4" aria-hidden="true"></a>ann.c1_predictions &lt;-<span class="st"> </span>ann.c1_predictions<span class="op">$</span>net.result</span>
<span id="cb72-5"><a href="ann-regression-and-classification.html#cb72-5" aria-hidden="true"></a></span>
<span id="cb72-6"><a href="ann-regression-and-classification.html#cb72-6" aria-hidden="true"></a><span class="co"># The prediction result shows the probability of each class</span></span>
<span id="cb72-7"><a href="ann-regression-and-classification.html#cb72-7" aria-hidden="true"></a><span class="co"># with first column corresponding to benign and second to malignant</span></span>
<span id="cb72-8"><a href="ann-regression-and-classification.html#cb72-8" aria-hidden="true"></a><span class="co"># we know as by typing str(data.breast) we can see that our Class is ordered benign and malignant</span></span>
<span id="cb72-9"><a href="ann-regression-and-classification.html#cb72-9" aria-hidden="true"></a><span class="kw">head</span>(ann.c1_predictions)</span>
<span id="cb72-10"><a href="ann-regression-and-classification.html#cb72-10" aria-hidden="true"></a><span class="co">##           [,1]         [,2]</span></span>
<span id="cb72-11"><a href="ann-regression-and-classification.html#cb72-11" aria-hidden="true"></a><span class="co">## 13 0.003303861 9.965274e-01</span></span>
<span id="cb72-12"><a href="ann-regression-and-classification.html#cb72-12" aria-hidden="true"></a><span class="co">## 17 1.000000000 1.278634e-10</span></span>
<span id="cb72-13"><a href="ann-regression-and-classification.html#cb72-13" aria-hidden="true"></a><span class="co">## 20 1.000000000 3.511953e-10</span></span>
<span id="cb72-14"><a href="ann-regression-and-classification.html#cb72-14" aria-hidden="true"></a><span class="co">## 23 1.000000000 9.554493e-11</span></span>
<span id="cb72-15"><a href="ann-regression-and-classification.html#cb72-15" aria-hidden="true"></a><span class="co">## 27 0.999999999 4.639298e-10</span></span>
<span id="cb72-16"><a href="ann-regression-and-classification.html#cb72-16" aria-hidden="true"></a><span class="co">## 31 1.000000000 2.895116e-10</span></span>
<span id="cb72-17"><a href="ann-regression-and-classification.html#cb72-17" aria-hidden="true"></a></span>
<span id="cb72-18"><a href="ann-regression-and-classification.html#cb72-18" aria-hidden="true"></a><span class="co"># So we need the extract the class with the highest prediction values as the predicted result</span></span>
<span id="cb72-19"><a href="ann-regression-and-classification.html#cb72-19" aria-hidden="true"></a><span class="co"># e.g by using ifelse</span></span>
<span id="cb72-20"><a href="ann-regression-and-classification.html#cb72-20" aria-hidden="true"></a>ann.c1_pred &lt;-<span class="st"> </span><span class="kw">max.col</span>(ann.c1_predictions) <span class="co"># find out which column has the maximum value</span></span>
<span id="cb72-21"><a href="ann-regression-and-classification.html#cb72-21" aria-hidden="true"></a>ann.c1_pred &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ann.c1_pred<span class="op">==</span><span class="dv">1</span>, <span class="st">&quot;benign&quot;</span>, <span class="st">&quot;malignant&quot;</span>) <span class="co"># if the first column was max, set it to beign, malignant otherwise</span></span>
<span id="cb72-22"><a href="ann-regression-and-classification.html#cb72-22" aria-hidden="true"></a>ann1.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((ann.c1_pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(ann.c1_pred)</span>
<span id="cb72-23"><a href="ann-regression-and-classification.html#cb72-23" aria-hidden="true"></a><span class="kw">print</span>(ann1.cr)</span>
<span id="cb72-24"><a href="ann-regression-and-classification.html#cb72-24" aria-hidden="true"></a><span class="co">## [1] 0.9470588</span></span>
<span id="cb72-25"><a href="ann-regression-and-classification.html#cb72-25" aria-hidden="true"></a></span>
<span id="cb72-26"><a href="ann-regression-and-classification.html#cb72-26" aria-hidden="true"></a><span class="co"># Compare with our previous models</span></span>
<span id="cb72-27"><a href="ann-regression-and-classification.html#cb72-27" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(knn.cr, cart.cr, logreg.cr, ann1.cr))</span>
<span id="cb72-28"><a href="ann-regression-and-classification.html#cb72-28" aria-hidden="true"></a><span class="co">## [1] 0.9588235 0.9352941 0.9411765 0.9470588</span></span>
<span id="cb72-29"><a href="ann-regression-and-classification.html#cb72-29" aria-hidden="true"></a></span>
<span id="cb72-30"><a href="ann-regression-and-classification.html#cb72-30" aria-hidden="true"></a><span class="co"># Note: we see we are not doing quite similar to logistic regression</span></span>
<span id="cb72-31"><a href="ann-regression-and-classification.html#cb72-31" aria-hidden="true"></a><span class="co"># It is not surprising as we only have one hidden layer with only one node with logistic activation function</span></span>
<span id="cb72-32"><a href="ann-regression-and-classification.html#cb72-32" aria-hidden="true"></a><span class="co"># and the linear regression can be viewed as a simple special case of neural network with no hidden layer</span></span></code></pre></div>
</div>
<div id="ann-classification-adding-hidden-layers" class="section level3" number="13.1.7">
<h3><span class="header-section-number">13.1.7</span> ANN classification: adding hidden layers</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ann-regression-and-classification.html#cb73-1" aria-hidden="true"></a><span class="co"># Lets add some more 2 more hidden layers, with 2 and 5 nodes, via hidden parameter</span></span>
<span id="cb73-2"><a href="ann-regression-and-classification.html#cb73-2" aria-hidden="true"></a><span class="co"># and see if our predictions improve</span></span>
<span id="cb73-3"><a href="ann-regression-and-classification.html#cb73-3" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb73-4"><a href="ann-regression-and-classification.html#cb73-4" aria-hidden="true"></a>ann.c2 &lt;-<span class="st"> </span><span class="kw">neuralnet</span>(Class <span class="op">~</span><span class="st"> </span>Cl.thickness <span class="op">+</span><span class="st"> </span>Cell.size <span class="op">+</span><span class="st">  </span>Cell.shape <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-5"><a href="ann-regression-and-classification.html#cb73-5" aria-hidden="true"></a><span class="st">                        </span>Marg.adhesion <span class="op">+</span><span class="st"> </span>Epith.c.size <span class="op">+</span><span class="st"> </span>Bare.nuclei <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-6"><a href="ann-regression-and-classification.html#cb73-6" aria-hidden="true"></a><span class="st">                        </span>Bl.cromatin <span class="op">+</span><span class="st"> </span>Normal.nucleoli <span class="op">+</span><span class="st"> </span>Mitoses, </span>
<span id="cb73-7"><a href="ann-regression-and-classification.html#cb73-7" aria-hidden="true"></a>                        <span class="dt">data=</span>data.train, </span>
<span id="cb73-8"><a href="ann-regression-and-classification.html#cb73-8" aria-hidden="true"></a>                        <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),</span>
<span id="cb73-9"><a href="ann-regression-and-classification.html#cb73-9" aria-hidden="true"></a>                        <span class="dt">linear.output =</span> <span class="ot">FALSE</span>, </span>
<span id="cb73-10"><a href="ann-regression-and-classification.html#cb73-10" aria-hidden="true"></a>                        <span class="dt">act.fct =</span> <span class="st">&quot;logistic&quot;</span>)</span>
<span id="cb73-11"><a href="ann-regression-and-classification.html#cb73-11" aria-hidden="true"></a></span>
<span id="cb73-12"><a href="ann-regression-and-classification.html#cb73-12" aria-hidden="true"></a><span class="kw">plotnet</span>(ann.c2, <span class="dt">cex_val =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="402-ann-intro_files/figure-html/unnamed-chunk-3-1.png" alt="ANN model representation for classification, two hidden layers, with two and five nodes respectively" width="672" />
<p class="caption">
Figure 3.4: ANN model representation for classification, two hidden layers, with two and five nodes respectively
</p>
</div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ann-regression-and-classification.html#cb74-1" aria-hidden="true"></a></span>
<span id="cb74-2"><a href="ann-regression-and-classification.html#cb74-2" aria-hidden="true"></a></span>
<span id="cb74-3"><a href="ann-regression-and-classification.html#cb74-3" aria-hidden="true"></a>ann.c2_predictions &lt;-<span class="st"> </span>neuralnet<span class="op">::</span><span class="kw">compute</span>(ann.c2, data.test)<span class="op">$</span>net.result</span>
<span id="cb74-4"><a href="ann-regression-and-classification.html#cb74-4" aria-hidden="true"></a>ann.c2_pred &lt;-<span class="st"> </span><span class="kw">max.col</span>(ann.c2_predictions) <span class="co"># find out which column has the maximum value</span></span>
<span id="cb74-5"><a href="ann-regression-and-classification.html#cb74-5" aria-hidden="true"></a>ann.c2_pred &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ann.c2_pred<span class="op">==</span><span class="dv">1</span>, <span class="st">&quot;benign&quot;</span>, <span class="st">&quot;malignant&quot;</span>) <span class="co"># if the first column was max, set it to beign, malignant otherwise</span></span>
<span id="cb74-6"><a href="ann-regression-and-classification.html#cb74-6" aria-hidden="true"></a>ann2.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((ann.c2_pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(ann.c2_pred)</span>
<span id="cb74-7"><a href="ann-regression-and-classification.html#cb74-7" aria-hidden="true"></a></span>
<span id="cb74-8"><a href="ann-regression-and-classification.html#cb74-8" aria-hidden="true"></a><span class="co"># Compare with our previous models</span></span>
<span id="cb74-9"><a href="ann-regression-and-classification.html#cb74-9" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(knn.cr, cart.cr, logreg.cr, ann1.cr, ann2.cr))</span>
<span id="cb74-10"><a href="ann-regression-and-classification.html#cb74-10" aria-hidden="true"></a><span class="co">## [1] 0.9588235 0.9352941 0.9411765 0.9470588 0.9529412</span></span>
<span id="cb74-11"><a href="ann-regression-and-classification.html#cb74-11" aria-hidden="true"></a></span>
<span id="cb74-12"><a href="ann-regression-and-classification.html#cb74-12" aria-hidden="true"></a><span class="co"># Feel free to experiment with more layers and more nodes</span></span></code></pre></div>
<!-- # For multi-class problems softmax activation function is used (equivalent to multiple logistic regression) -->
</div>
<div id="ann-classification-changing-activation-function" class="section level3" number="13.1.8">
<h3><span class="header-section-number">13.1.8</span> ANN classification: changing activation function</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ann-regression-and-classification.html#cb75-1" aria-hidden="true"></a><span class="co"># We can change activation function via act.fct parameter and include custom functions</span></span>
<span id="cb75-2"><a href="ann-regression-and-classification.html#cb75-2" aria-hidden="true"></a><span class="co"># e.g. softplus &lt;- function(x) log(1 + exp(x)) </span></span>
<span id="cb75-3"><a href="ann-regression-and-classification.html#cb75-3" aria-hidden="true"></a><span class="co"># or relu &lt;- function(x) sapply(x, function(z) max(0,z))</span></span>
<span id="cb75-4"><a href="ann-regression-and-classification.html#cb75-4" aria-hidden="true"></a><span class="co"># here we switch to &quot;tanh&quot; from a default &quot;logistic&quot;</span></span>
<span id="cb75-5"><a href="ann-regression-and-classification.html#cb75-5" aria-hidden="true"></a></span>
<span id="cb75-6"><a href="ann-regression-and-classification.html#cb75-6" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb75-7"><a href="ann-regression-and-classification.html#cb75-7" aria-hidden="true"></a>ann.c3 &lt;-<span class="st"> </span><span class="kw">neuralnet</span>(Class <span class="op">~</span><span class="st"> </span>Cl.thickness <span class="op">+</span><span class="st"> </span>Cell.size <span class="op">+</span><span class="st">  </span>Cell.shape <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-8"><a href="ann-regression-and-classification.html#cb75-8" aria-hidden="true"></a><span class="st">                        </span>Marg.adhesion <span class="op">+</span><span class="st"> </span>Epith.c.size <span class="op">+</span><span class="st"> </span>Bare.nuclei <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-9"><a href="ann-regression-and-classification.html#cb75-9" aria-hidden="true"></a><span class="st">                        </span>Bl.cromatin <span class="op">+</span><span class="st"> </span>Normal.nucleoli <span class="op">+</span><span class="st"> </span>Mitoses, </span>
<span id="cb75-10"><a href="ann-regression-and-classification.html#cb75-10" aria-hidden="true"></a>                        <span class="dt">data=</span>data.train, </span>
<span id="cb75-11"><a href="ann-regression-and-classification.html#cb75-11" aria-hidden="true"></a>                        <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),</span>
<span id="cb75-12"><a href="ann-regression-and-classification.html#cb75-12" aria-hidden="true"></a>                        <span class="dt">linear.output =</span> <span class="ot">FALSE</span>, </span>
<span id="cb75-13"><a href="ann-regression-and-classification.html#cb75-13" aria-hidden="true"></a>                        <span class="dt">act.fct =</span> <span class="st">&quot;tanh&quot;</span>)</span>
<span id="cb75-14"><a href="ann-regression-and-classification.html#cb75-14" aria-hidden="true"></a></span>
<span id="cb75-15"><a href="ann-regression-and-classification.html#cb75-15" aria-hidden="true"></a>ann.c3_predictions &lt;-<span class="st"> </span>neuralnet<span class="op">::</span><span class="kw">compute</span>(ann.c3, data.test)<span class="op">$</span>net.result</span>
<span id="cb75-16"><a href="ann-regression-and-classification.html#cb75-16" aria-hidden="true"></a>ann.c3_pred &lt;-<span class="st"> </span><span class="kw">max.col</span>(ann.c3_predictions) <span class="co"># find out which column has the maximum value</span></span>
<span id="cb75-17"><a href="ann-regression-and-classification.html#cb75-17" aria-hidden="true"></a>ann.c3_pred &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ann.c3_pred<span class="op">==</span><span class="dv">1</span>, <span class="st">&quot;benign&quot;</span>, <span class="st">&quot;malignant&quot;</span>) <span class="co"># if the first column was max, set it to benign, malignant otherwise</span></span>
<span id="cb75-18"><a href="ann-regression-and-classification.html#cb75-18" aria-hidden="true"></a>ann3.cr &lt;-<span class="st"> </span><span class="kw">sum</span>((ann.c3_pred<span class="op">==</span>data.test[,<span class="dv">1</span>]))<span class="op">/</span><span class="kw">length</span>(ann.c3_pred)</span>
<span id="cb75-19"><a href="ann-regression-and-classification.html#cb75-19" aria-hidden="true"></a></span>
<span id="cb75-20"><a href="ann-regression-and-classification.html#cb75-20" aria-hidden="true"></a><span class="co"># Compare with our previous models</span></span>
<span id="cb75-21"><a href="ann-regression-and-classification.html#cb75-21" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(knn.cr, cart.cr, logreg.cr, ann1.cr, ann2.cr, ann3.cr))</span>
<span id="cb75-22"><a href="ann-regression-and-classification.html#cb75-22" aria-hidden="true"></a><span class="co">## [1] 0.9588235 0.9352941 0.9411765 0.9470588 0.9529412 0.7000000</span></span></code></pre></div>
</div>
<div id="ann-regression" class="section level3" number="13.1.9">
<h3><span class="header-section-number">13.1.9</span> ANN regression</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ann-regression-and-classification.html#cb76-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="ann-regression-and-classification.html#cb76-2" aria-hidden="true"></a></span>
<span id="cb76-3"><a href="ann-regression-and-classification.html#cb76-3" aria-hidden="true"></a><span class="co"># read in data on Pima Indians Diabeses Database</span></span>
<span id="cb76-4"><a href="ann-regression-and-classification.html#cb76-4" aria-hidden="true"></a><span class="kw">data</span>(PimaIndiansDiabetes)</span>
<span id="cb76-5"><a href="ann-regression-and-classification.html#cb76-5" aria-hidden="true"></a><span class="kw">head</span>(PimaIndiansDiabetes)</span>
<span id="cb76-6"><a href="ann-regression-and-classification.html#cb76-6" aria-hidden="true"></a><span class="co">##   pregnant glucose pressure triceps insulin mass pedigree age diabetes</span></span>
<span id="cb76-7"><a href="ann-regression-and-classification.html#cb76-7" aria-hidden="true"></a><span class="co">## 1        6     148       72      35       0 33.6    0.627  50      pos</span></span>
<span id="cb76-8"><a href="ann-regression-and-classification.html#cb76-8" aria-hidden="true"></a><span class="co">## 2        1      85       66      29       0 26.6    0.351  31      neg</span></span>
<span id="cb76-9"><a href="ann-regression-and-classification.html#cb76-9" aria-hidden="true"></a><span class="co">## 3        8     183       64       0       0 23.3    0.672  32      pos</span></span>
<span id="cb76-10"><a href="ann-regression-and-classification.html#cb76-10" aria-hidden="true"></a><span class="co">## 4        1      89       66      23      94 28.1    0.167  21      neg</span></span>
<span id="cb76-11"><a href="ann-regression-and-classification.html#cb76-11" aria-hidden="true"></a><span class="co">## 5        0     137       40      35     168 43.1    2.288  33      pos</span></span>
<span id="cb76-12"><a href="ann-regression-and-classification.html#cb76-12" aria-hidden="true"></a><span class="co">## 6        5     116       74       0       0 25.6    0.201  30      neg</span></span>
<span id="cb76-13"><a href="ann-regression-and-classification.html#cb76-13" aria-hidden="true"></a><span class="kw">summary</span>(PimaIndiansDiabetes)</span>
<span id="cb76-14"><a href="ann-regression-and-classification.html#cb76-14" aria-hidden="true"></a><span class="co">##     pregnant         glucose         pressure         triceps     </span></span>
<span id="cb76-15"><a href="ann-regression-and-classification.html#cb76-15" aria-hidden="true"></a><span class="co">##  Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  </span></span>
<span id="cb76-16"><a href="ann-regression-and-classification.html#cb76-16" aria-hidden="true"></a><span class="co">##  1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  </span></span>
<span id="cb76-17"><a href="ann-regression-and-classification.html#cb76-17" aria-hidden="true"></a><span class="co">##  Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  </span></span>
<span id="cb76-18"><a href="ann-regression-and-classification.html#cb76-18" aria-hidden="true"></a><span class="co">##  Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  </span></span>
<span id="cb76-19"><a href="ann-regression-and-classification.html#cb76-19" aria-hidden="true"></a><span class="co">##  3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  </span></span>
<span id="cb76-20"><a href="ann-regression-and-classification.html#cb76-20" aria-hidden="true"></a><span class="co">##  Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  </span></span>
<span id="cb76-21"><a href="ann-regression-and-classification.html#cb76-21" aria-hidden="true"></a><span class="co">##     insulin           mass          pedigree           age        diabetes </span></span>
<span id="cb76-22"><a href="ann-regression-and-classification.html#cb76-22" aria-hidden="true"></a><span class="co">##  Min.   :  0.0   Min.   : 0.00   Min.   :0.0780   Min.   :21.00   neg:500  </span></span>
<span id="cb76-23"><a href="ann-regression-and-classification.html#cb76-23" aria-hidden="true"></a><span class="co">##  1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437   1st Qu.:24.00   pos:268  </span></span>
<span id="cb76-24"><a href="ann-regression-and-classification.html#cb76-24" aria-hidden="true"></a><span class="co">##  Median : 30.5   Median :32.00   Median :0.3725   Median :29.00            </span></span>
<span id="cb76-25"><a href="ann-regression-and-classification.html#cb76-25" aria-hidden="true"></a><span class="co">##  Mean   : 79.8   Mean   :31.99   Mean   :0.4719   Mean   :33.24            </span></span>
<span id="cb76-26"><a href="ann-regression-and-classification.html#cb76-26" aria-hidden="true"></a><span class="co">##  3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262   3rd Qu.:41.00            </span></span>
<span id="cb76-27"><a href="ann-regression-and-classification.html#cb76-27" aria-hidden="true"></a><span class="co">##  Max.   :846.0   Max.   :67.10   Max.   :2.4200   Max.   :81.00</span></span>
<span id="cb76-28"><a href="ann-regression-and-classification.html#cb76-28" aria-hidden="true"></a><span class="kw">str</span>(PimaIndiansDiabetes)</span>
<span id="cb76-29"><a href="ann-regression-and-classification.html#cb76-29" aria-hidden="true"></a><span class="co">## &#39;data.frame&#39;:	768 obs. of  9 variables:</span></span>
<span id="cb76-30"><a href="ann-regression-and-classification.html#cb76-30" aria-hidden="true"></a><span class="co">##  $ pregnant: num  6 1 8 1 0 5 3 10 2 8 ...</span></span>
<span id="cb76-31"><a href="ann-regression-and-classification.html#cb76-31" aria-hidden="true"></a><span class="co">##  $ glucose : num  148 85 183 89 137 116 78 115 197 125 ...</span></span>
<span id="cb76-32"><a href="ann-regression-and-classification.html#cb76-32" aria-hidden="true"></a><span class="co">##  $ pressure: num  72 66 64 66 40 74 50 0 70 96 ...</span></span>
<span id="cb76-33"><a href="ann-regression-and-classification.html#cb76-33" aria-hidden="true"></a><span class="co">##  $ triceps : num  35 29 0 23 35 0 32 0 45 0 ...</span></span>
<span id="cb76-34"><a href="ann-regression-and-classification.html#cb76-34" aria-hidden="true"></a><span class="co">##  $ insulin : num  0 0 0 94 168 0 88 0 543 0 ...</span></span>
<span id="cb76-35"><a href="ann-regression-and-classification.html#cb76-35" aria-hidden="true"></a><span class="co">##  $ mass    : num  33.6 26.6 23.3 28.1 43.1 25.6 31 35.3 30.5 0 ...</span></span>
<span id="cb76-36"><a href="ann-regression-and-classification.html#cb76-36" aria-hidden="true"></a><span class="co">##  $ pedigree: num  0.627 0.351 0.672 0.167 2.288 ...</span></span>
<span id="cb76-37"><a href="ann-regression-and-classification.html#cb76-37" aria-hidden="true"></a><span class="co">##  $ age     : num  50 31 32 21 33 30 26 29 53 54 ...</span></span>
<span id="cb76-38"><a href="ann-regression-and-classification.html#cb76-38" aria-hidden="true"></a><span class="co">##  $ diabetes: Factor w/ 2 levels &quot;neg&quot;,&quot;pos&quot;: 2 1 2 1 2 1 2 1 2 2 ...</span></span>
<span id="cb76-39"><a href="ann-regression-and-classification.html#cb76-39" aria-hidden="true"></a><span class="co"># pregnant: Number of times pregnant</span></span>
<span id="cb76-40"><a href="ann-regression-and-classification.html#cb76-40" aria-hidden="true"></a><span class="co"># glucose: Plasma glucose concentration (glucose tolerance test) </span></span>
<span id="cb76-41"><a href="ann-regression-and-classification.html#cb76-41" aria-hidden="true"></a><span class="co"># pressure: Diastolic blood pressure (mm Hg)</span></span>
<span id="cb76-42"><a href="ann-regression-and-classification.html#cb76-42" aria-hidden="true"></a><span class="co"># triceps: Triceps skin fold thickness (mm)</span></span>
<span id="cb76-43"><a href="ann-regression-and-classification.html#cb76-43" aria-hidden="true"></a><span class="co"># insulin: 2-Hour serum insulin (mu U/ml)</span></span>
<span id="cb76-44"><a href="ann-regression-and-classification.html#cb76-44" aria-hidden="true"></a><span class="co"># mass: Body mass index (weight in kg/(height in m)\^2) Diabetes pedigree function</span></span>
<span id="cb76-45"><a href="ann-regression-and-classification.html#cb76-45" aria-hidden="true"></a><span class="co"># age: Age (years)</span></span>
<span id="cb76-46"><a href="ann-regression-and-classification.html#cb76-46" aria-hidden="true"></a><span class="co"># diabetes: Class variable (test for diabetes)</span></span>
<span id="cb76-47"><a href="ann-regression-and-classification.html#cb76-47" aria-hidden="true"></a></span>
<span id="cb76-48"><a href="ann-regression-and-classification.html#cb76-48" aria-hidden="true"></a><span class="co"># remove missing values i.e. some mass measurements are 0</span></span>
<span id="cb76-49"><a href="ann-regression-and-classification.html#cb76-49" aria-hidden="true"></a>idx<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">which</span>(PimaIndiansDiabetes<span class="op">$</span>mass <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb76-50"><a href="ann-regression-and-classification.html#cb76-50" aria-hidden="true"></a>data.pima &lt;-<span class="st"> </span>PimaIndiansDiabetes[<span class="op">-</span>idx<span class="fl">.0</span>,]</span>
<span id="cb76-51"><a href="ann-regression-and-classification.html#cb76-51" aria-hidden="true"></a></span>
<span id="cb76-52"><a href="ann-regression-and-classification.html#cb76-52" aria-hidden="true"></a><span class="co"># re-scale data</span></span>
<span id="cb76-53"><a href="ann-regression-and-classification.html#cb76-53" aria-hidden="true"></a>data.pima<span class="op">$</span>diabetes &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data.pima<span class="op">$</span>diabetes)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb76-54"><a href="ann-regression-and-classification.html#cb76-54" aria-hidden="true"></a>maxs &lt;-<span class="st"> </span><span class="kw">apply</span>(data.pima, <span class="dv">2</span>, max)</span>
<span id="cb76-55"><a href="ann-regression-and-classification.html#cb76-55" aria-hidden="true"></a>mins &lt;-<span class="st"> </span><span class="kw">apply</span>(data.pima, <span class="dv">2</span>, min)</span>
<span id="cb76-56"><a href="ann-regression-and-classification.html#cb76-56" aria-hidden="true"></a>data.pima &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">scale</span>(data.pima, <span class="dt">center=</span>mins, <span class="dt">scale=</span>maxs <span class="op">-</span><span class="st"> </span>mins))</span>
<span id="cb76-57"><a href="ann-regression-and-classification.html#cb76-57" aria-hidden="true"></a><span class="kw">head</span>(data.pima)</span>
<span id="cb76-58"><a href="ann-regression-and-classification.html#cb76-58" aria-hidden="true"></a><span class="co">##     pregnant   glucose  pressure   triceps   insulin      mass   pedigree</span></span>
<span id="cb76-59"><a href="ann-regression-and-classification.html#cb76-59" aria-hidden="true"></a><span class="co">## 1 0.35294118 0.7437186 0.5901639 0.3535354 0.0000000 0.3149284 0.23441503</span></span>
<span id="cb76-60"><a href="ann-regression-and-classification.html#cb76-60" aria-hidden="true"></a><span class="co">## 2 0.05882353 0.4271357 0.5409836 0.2929293 0.0000000 0.1717791 0.11656704</span></span>
<span id="cb76-61"><a href="ann-regression-and-classification.html#cb76-61" aria-hidden="true"></a><span class="co">## 3 0.47058824 0.9195980 0.5245902 0.0000000 0.0000000 0.1042945 0.25362938</span></span>
<span id="cb76-62"><a href="ann-regression-and-classification.html#cb76-62" aria-hidden="true"></a><span class="co">## 4 0.05882353 0.4472362 0.5409836 0.2323232 0.1111111 0.2024540 0.03800171</span></span>
<span id="cb76-63"><a href="ann-regression-and-classification.html#cb76-63" aria-hidden="true"></a><span class="co">## 5 0.00000000 0.6884422 0.3278689 0.3535354 0.1985816 0.5092025 0.94363792</span></span>
<span id="cb76-64"><a href="ann-regression-and-classification.html#cb76-64" aria-hidden="true"></a><span class="co">## 6 0.29411765 0.5829146 0.6065574 0.0000000 0.0000000 0.1513292 0.05251921</span></span>
<span id="cb76-65"><a href="ann-regression-and-classification.html#cb76-65" aria-hidden="true"></a><span class="co">##         age diabetes</span></span>
<span id="cb76-66"><a href="ann-regression-and-classification.html#cb76-66" aria-hidden="true"></a><span class="co">## 1 0.4833333        1</span></span>
<span id="cb76-67"><a href="ann-regression-and-classification.html#cb76-67" aria-hidden="true"></a><span class="co">## 2 0.1666667        0</span></span>
<span id="cb76-68"><a href="ann-regression-and-classification.html#cb76-68" aria-hidden="true"></a><span class="co">## 3 0.1833333        1</span></span>
<span id="cb76-69"><a href="ann-regression-and-classification.html#cb76-69" aria-hidden="true"></a><span class="co">## 4 0.0000000        0</span></span>
<span id="cb76-70"><a href="ann-regression-and-classification.html#cb76-70" aria-hidden="true"></a><span class="co">## 5 0.2000000        1</span></span>
<span id="cb76-71"><a href="ann-regression-and-classification.html#cb76-71" aria-hidden="true"></a><span class="co">## 6 0.1500000        0</span></span>
<span id="cb76-72"><a href="ann-regression-and-classification.html#cb76-72" aria-hidden="true"></a></span>
<span id="cb76-73"><a href="ann-regression-and-classification.html#cb76-73" aria-hidden="true"></a><span class="co"># split into train and test</span></span>
<span id="cb76-74"><a href="ann-regression-and-classification.html#cb76-74" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(data.pima)</span>
<span id="cb76-75"><a href="ann-regression-and-classification.html#cb76-75" aria-hidden="true"></a>idx.train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n), <span class="kw">round</span>(n<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb76-76"><a href="ann-regression-and-classification.html#cb76-76" aria-hidden="true"></a>idx.test &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n), idx.train)</span>
<span id="cb76-77"><a href="ann-regression-and-classification.html#cb76-77" aria-hidden="true"></a>data.train &lt;-<span class="st"> </span>data.pima[idx.train, ]</span>
<span id="cb76-78"><a href="ann-regression-and-classification.html#cb76-78" aria-hidden="true"></a>data.test &lt;-<span class="st"> </span>data.pima[idx.test,]</span>
<span id="cb76-79"><a href="ann-regression-and-classification.html#cb76-79" aria-hidden="true"></a></span>
<span id="cb76-80"><a href="ann-regression-and-classification.html#cb76-80" aria-hidden="true"></a><span class="co"># fit multiple regression model to predict mass (BMI) based on other measurements</span></span>
<span id="cb76-81"><a href="ann-regression-and-classification.html#cb76-81" aria-hidden="true"></a>reg &lt;-<span class="st"> </span><span class="kw">lm</span>(mass <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>triceps <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(diabetes) <span class="op">+</span><span class="st"> </span>insulin <span class="op">+</span><span class="st"> </span>glucose <span class="op">+</span><span class="st"> </span>pregnant <span class="op">+</span><span class="st"> </span>pressure, <span class="dt">data =</span> data.train)</span>
<span id="cb76-82"><a href="ann-regression-and-classification.html#cb76-82" aria-hidden="true"></a><span class="kw">summary</span>(reg)</span>
<span id="cb76-83"><a href="ann-regression-and-classification.html#cb76-83" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb76-84"><a href="ann-regression-and-classification.html#cb76-84" aria-hidden="true"></a><span class="co">## Call:</span></span>
<span id="cb76-85"><a href="ann-regression-and-classification.html#cb76-85" aria-hidden="true"></a><span class="co">## lm(formula = mass ~ age + triceps + factor(diabetes) + insulin + </span></span>
<span id="cb76-86"><a href="ann-regression-and-classification.html#cb76-86" aria-hidden="true"></a><span class="co">##     glucose + pregnant + pressure, data = data.train)</span></span>
<span id="cb76-87"><a href="ann-regression-and-classification.html#cb76-87" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb76-88"><a href="ann-regression-and-classification.html#cb76-88" aria-hidden="true"></a><span class="co">## Residuals:</span></span>
<span id="cb76-89"><a href="ann-regression-and-classification.html#cb76-89" aria-hidden="true"></a><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb76-90"><a href="ann-regression-and-classification.html#cb76-90" aria-hidden="true"></a><span class="co">## -0.27091 -0.09095 -0.01383  0.07434  0.49669 </span></span>
<span id="cb76-91"><a href="ann-regression-and-classification.html#cb76-91" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb76-92"><a href="ann-regression-and-classification.html#cb76-92" aria-hidden="true"></a><span class="co">## Coefficients:</span></span>
<span id="cb76-93"><a href="ann-regression-and-classification.html#cb76-93" aria-hidden="true"></a><span class="co">##                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb76-94"><a href="ann-regression-and-classification.html#cb76-94" aria-hidden="true"></a><span class="co">## (Intercept)        0.10099    0.03375   2.992  0.00296 ** </span></span>
<span id="cb76-95"><a href="ann-regression-and-classification.html#cb76-95" aria-hidden="true"></a><span class="co">## age               -0.02083    0.04168  -0.500  0.61746    </span></span>
<span id="cb76-96"><a href="ann-regression-and-classification.html#cb76-96" aria-hidden="true"></a><span class="co">## triceps            0.30591    0.04332   7.062 8.20e-12 ***</span></span>
<span id="cb76-97"><a href="ann-regression-and-classification.html#cb76-97" aria-hidden="true"></a><span class="co">## factor(diabetes)1  0.09178    0.01520   6.037 3.82e-09 ***</span></span>
<span id="cb76-98"><a href="ann-regression-and-classification.html#cb76-98" aria-hidden="true"></a><span class="co">## insulin           -0.09777    0.06031  -1.621  0.10585    </span></span>
<span id="cb76-99"><a href="ann-regression-and-classification.html#cb76-99" aria-hidden="true"></a><span class="co">## glucose            0.02333    0.04736   0.493  0.62264    </span></span>
<span id="cb76-100"><a href="ann-regression-and-classification.html#cb76-100" aria-hidden="true"></a><span class="co">## pregnant          -0.06298    0.03806  -1.655  0.09883 .  </span></span>
<span id="cb76-101"><a href="ann-regression-and-classification.html#cb76-101" aria-hidden="true"></a><span class="co">## pressure           0.18860    0.04577   4.120 4.67e-05 ***</span></span>
<span id="cb76-102"><a href="ann-regression-and-classification.html#cb76-102" aria-hidden="true"></a><span class="co">## ---</span></span>
<span id="cb76-103"><a href="ann-regression-and-classification.html#cb76-103" aria-hidden="true"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb76-104"><a href="ann-regression-and-classification.html#cb76-104" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb76-105"><a href="ann-regression-and-classification.html#cb76-105" aria-hidden="true"></a><span class="co">## Residual standard error: 0.1219 on 370 degrees of freedom</span></span>
<span id="cb76-106"><a href="ann-regression-and-classification.html#cb76-106" aria-hidden="true"></a><span class="co">## Multiple R-squared:  0.2906,	Adjusted R-squared:  0.2772 </span></span>
<span id="cb76-107"><a href="ann-regression-and-classification.html#cb76-107" aria-hidden="true"></a><span class="co">## F-statistic: 21.65 on 7 and 370 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb76-108"><a href="ann-regression-and-classification.html#cb76-108" aria-hidden="true"></a></span>
<span id="cb76-109"><a href="ann-regression-and-classification.html#cb76-109" aria-hidden="true"></a><span class="co"># calculate sum of squared errors (SSE) </span></span>
<span id="cb76-110"><a href="ann-regression-and-classification.html#cb76-110" aria-hidden="true"></a>yhat.reg1 &lt;-<span class="st"> </span><span class="kw">predict</span>(reg, <span class="dt">newdata =</span> data.test)</span>
<span id="cb76-111"><a href="ann-regression-and-classification.html#cb76-111" aria-hidden="true"></a>reg.sse &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sse.train =</span> <span class="kw">sum</span>((reg<span class="op">$</span>fitted.values <span class="op">-</span><span class="st"> </span>data.train<span class="op">$</span>mass)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, </span>
<span id="cb76-112"><a href="ann-regression-and-classification.html#cb76-112" aria-hidden="true"></a>                      <span class="dt">sse.test =</span> <span class="kw">sum</span>((yhat.reg1 <span class="op">-</span><span class="st"> </span>data.test<span class="op">$</span>mass)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb76-113"><a href="ann-regression-and-classification.html#cb76-113" aria-hidden="true"></a></span>
<span id="cb76-114"><a href="ann-regression-and-classification.html#cb76-114" aria-hidden="true"></a><span class="co"># fit ANN regression model</span></span>
<span id="cb76-115"><a href="ann-regression-and-classification.html#cb76-115" aria-hidden="true"></a><span class="co"># notice linear.output set to TRUE this time</span></span>
<span id="cb76-116"><a href="ann-regression-and-classification.html#cb76-116" aria-hidden="true"></a>ann.r1 &lt;-<span class="st"> </span><span class="kw">neuralnet</span>(mass <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span>triceps  <span class="op">+</span><span class="st"> </span>insulin <span class="op">+</span><span class="st"> </span>glucose <span class="op">+</span><span class="st"> </span>pregnant <span class="op">+</span><span class="st"> </span>pressure, </span>
<span id="cb76-117"><a href="ann-regression-and-classification.html#cb76-117" aria-hidden="true"></a>                        <span class="dt">data =</span> data.train,</span>
<span id="cb76-118"><a href="ann-regression-and-classification.html#cb76-118" aria-hidden="true"></a>                        <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">5</span>),</span>
<span id="cb76-119"><a href="ann-regression-and-classification.html#cb76-119" aria-hidden="true"></a>                        <span class="dt">linear.output =</span> <span class="ot">TRUE</span>)</span>
<span id="cb76-120"><a href="ann-regression-and-classification.html#cb76-120" aria-hidden="true"></a></span>
<span id="cb76-121"><a href="ann-regression-and-classification.html#cb76-121" aria-hidden="true"></a><span class="kw">plotnet</span>(ann.r1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5-1"></span>
<img src="402-ann-intro_files/figure-html/unnamed-chunk-5-1.png" alt="ANN network visualisation for regression" width="672" />
<p class="caption">
Figure 13.2: ANN network visualisation for regression
</p>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="ann-regression-and-classification.html#cb77-1" aria-hidden="true"></a></span>
<span id="cb77-2"><a href="ann-regression-and-classification.html#cb77-2" aria-hidden="true"></a><span class="co"># SSE and RMSE errors</span></span>
<span id="cb77-3"><a href="ann-regression-and-classification.html#cb77-3" aria-hidden="true"></a>yhat.annr1 &lt;-<span class="st"> </span>neuralnet<span class="op">::</span><span class="kw">compute</span>(ann.r1, data.test)<span class="op">$</span>net.result</span>
<span id="cb77-4"><a href="ann-regression-and-classification.html#cb77-4" aria-hidden="true"></a>annr1.sse &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sse.train =</span> <span class="kw">sum</span>((ann.r1<span class="op">$</span>net.result[[<span class="dv">1</span>]] <span class="op">-</span><span class="st"> </span>data.train<span class="op">$</span>mass)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, </span>
<span id="cb77-5"><a href="ann-regression-and-classification.html#cb77-5" aria-hidden="true"></a>                      <span class="dt">sse.test =</span> <span class="kw">sum</span>((yhat.annr1 <span class="op">-</span><span class="st"> </span>data.train<span class="op">$</span>mass)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb77-6"><a href="ann-regression-and-classification.html#cb77-6" aria-hidden="true"></a><span class="co">## Warning in yhat.annr1 - data.train$mass: longer object length is not a multiple</span></span>
<span id="cb77-7"><a href="ann-regression-and-classification.html#cb77-7" aria-hidden="true"></a><span class="co">## of shorter object length</span></span>
<span id="cb77-8"><a href="ann-regression-and-classification.html#cb77-8" aria-hidden="true"></a></span>
<span id="cb77-9"><a href="ann-regression-and-classification.html#cb77-9" aria-hidden="true"></a><span class="co"># compare SSE errors for train and test between multiple regression and ANN</span></span>
<span id="cb77-10"><a href="ann-regression-and-classification.html#cb77-10" aria-hidden="true"></a><span class="kw">print</span>(reg.sse)</span>
<span id="cb77-11"><a href="ann-regression-and-classification.html#cb77-11" aria-hidden="true"></a><span class="co">##   sse.train sse.test</span></span>
<span id="cb77-12"><a href="ann-regression-and-classification.html#cb77-12" aria-hidden="true"></a><span class="co">## 1  2.751006  3.04521</span></span>
<span id="cb77-13"><a href="ann-regression-and-classification.html#cb77-13" aria-hidden="true"></a><span class="kw">print</span>(annr1.sse)</span>
<span id="cb77-14"><a href="ann-regression-and-classification.html#cb77-14" aria-hidden="true"></a><span class="co">##   sse.train sse.test</span></span>
<span id="cb77-15"><a href="ann-regression-and-classification.html#cb77-15" aria-hidden="true"></a><span class="co">## 1  2.109606 137.7486</span></span>
<span id="cb77-16"><a href="ann-regression-and-classification.html#cb77-16" aria-hidden="true"></a></span>
<span id="cb77-17"><a href="ann-regression-and-classification.html#cb77-17" aria-hidden="true"></a><span class="co"># plot predicted values vs. mass values for the train and test data separately</span></span>
<span id="cb77-18"><a href="ann-regression-and-classification.html#cb77-18" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb77-19"><a href="ann-regression-and-classification.html#cb77-19" aria-hidden="true"></a><span class="kw">plot</span>(data.train<span class="op">$</span>mass, reg<span class="op">$</span>fitted.values, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;mass (true value)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Prediction&quot;</span>)</span>
<span id="cb77-20"><a href="ann-regression-and-classification.html#cb77-20" aria-hidden="true"></a><span class="kw">points</span>(data.train<span class="op">$</span>mass, ann.r1<span class="op">$</span>net.result[[<span class="dv">1</span>]], <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;coral2&quot;</span>)</span>
<span id="cb77-21"><a href="ann-regression-and-classification.html#cb77-21" aria-hidden="true"></a><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span><span class="op">:</span><span class="dv">100</span>), <span class="dt">y=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span><span class="op">:</span><span class="dv">100</span>))</span>
<span id="cb77-22"><a href="ann-regression-and-classification.html#cb77-22" aria-hidden="true"></a></span>
<span id="cb77-23"><a href="ann-regression-and-classification.html#cb77-23" aria-hidden="true"></a><span class="kw">plot</span>(data.test<span class="op">$</span>mass, yhat.reg1, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;mass (true value)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Prediction&quot;</span>)</span>
<span id="cb77-24"><a href="ann-regression-and-classification.html#cb77-24" aria-hidden="true"></a><span class="kw">points</span>(data.test<span class="op">$</span>mass, yhat.annr1, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;coral2&quot;</span>)</span>
<span id="cb77-25"><a href="ann-regression-and-classification.html#cb77-25" aria-hidden="true"></a><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span><span class="op">:</span><span class="dv">100</span>), <span class="dt">y=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span><span class="op">:</span><span class="dv">100</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5-2"></span>
<img src="402-ann-intro_files/figure-html/unnamed-chunk-5-2.png" alt="Comparison of predicted values vs. known values with linear regression (blue) and ANN (red) on the training data set (left) and on the test data set (right)" width="672" />
<p class="caption">
Figure 13.3: Comparison of predicted values vs.Â known values with linear regression (blue) and ANN (red) on the training data set (left) and on the test data set (right)
</p>
</div>
</div>
<div id="ann-rep-value" class="section level3" number="13.1.10">
<h3><span class="header-section-number">13.1.10</span> ANN rep value</h3>
<p>Have we said at the lecture that the weights are randomly assigned at the start? How do we know that we have a best network? Above we have looked at one network and used a random seed to ensure reproducibility of the results. We could have been just unlucky with our comparisons to logigits or linear regression. In practice, one would fit many networks and choose a best one</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="ann-regression-and-classification.html#cb78-1" aria-hidden="true"></a><span class="co"># Here we will set rep to 5, it is getting computationally heavy</span></span>
<span id="cb78-2"><a href="ann-regression-and-classification.html#cb78-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb78-3"><a href="ann-regression-and-classification.html#cb78-3" aria-hidden="true"></a>ann.r2 &lt;-<span class="st"> </span><span class="kw">neuralnet</span>(mass <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span>triceps  <span class="op">+</span><span class="st"> </span>insulin <span class="op">+</span><span class="st"> </span>glucose <span class="op">+</span><span class="st"> </span>pregnant <span class="op">+</span><span class="st"> </span>pressure, </span>
<span id="cb78-4"><a href="ann-regression-and-classification.html#cb78-4" aria-hidden="true"></a>                        <span class="dt">data =</span> data.train,</span>
<span id="cb78-5"><a href="ann-regression-and-classification.html#cb78-5" aria-hidden="true"></a>                        <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">5</span>),</span>
<span id="cb78-6"><a href="ann-regression-and-classification.html#cb78-6" aria-hidden="true"></a>                        <span class="dt">linear.output =</span> <span class="ot">TRUE</span>, </span>
<span id="cb78-7"><a href="ann-regression-and-classification.html#cb78-7" aria-hidden="true"></a>                        <span class="dt">rep =</span> <span class="dv">5</span>)</span>
<span id="cb78-8"><a href="ann-regression-and-classification.html#cb78-8" aria-hidden="true"></a></span>
<span id="cb78-9"><a href="ann-regression-and-classification.html#cb78-9" aria-hidden="true"></a><span class="co">#plot(ann.r2, rep = &quot;best&quot;)</span></span></code></pre></div>
</div>
<div id="ann-relative-importance-of-variables" class="section level3" number="13.1.11">
<h3><span class="header-section-number">13.1.11</span> ANN relative importance of variables</h3>
<ul>
<li>Weights that connect nodes in a neural network cannot be interpreted as the parameters coefficients of a standard linear regression model</li>
<li>They can be thought of as analogous to them and can be used to describe relationships between variables</li>
<li>i.e.Â weights dictate the relative influence of information that is processed in the network such that input variables that are not relevant in terms of their correlation with the response are suppressed by the weights</li>
<li>A difference between neural network and a regression model is that the number of weights is excessive in the former case</li>
<li>This makes neural network powerful and flexible, the price for that is easiness of integration of the model, it is not so straightforward anymore</li>
<li>One method to identify the relative importance of the covariates is by Garson (1991) and is based by deconstructing the model weights (implented in NerualNetTools)</li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ann-regression-and-classification.html#cb79-1" aria-hidden="true"></a><span class="kw">garson</span>(ann.r1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="402-ann-intro_files/figure-html/unnamed-chunk-7-1.png" alt="Output of the variable important call for one of the ANN regression models" width="672" />
<p class="caption">
Figure 11.2: Output of the variable important call for one of the ANN regression models
</p>
</div>
<p>Feel free to experiment with different options of the neuralnet() and different datasets that we have used so far. Do note however, that neurlanet() package is great fpr getting some ideas about running ANN, the heavy duty work is done on GPUs typically via <a href="https://tensorflow.rstudio.com/guide/keras/">Keras</a>, often in Python, although now <a href="https://tensorflow.rstudio.com">Tensforlow</a> is available for R as well.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="classification-with-knn-and-decision-trees.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introduction-to-biostatistics-and-machine-learning.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
